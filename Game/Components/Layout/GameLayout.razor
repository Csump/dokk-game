@inherits LayoutComponentBase
@using Game.Services
@using Game.Components.Shared
@implements IDisposable

@inject GameState GameState
@inject NavigationManager Navigation

<a href="https://www.dokk.elte.hu/" 
   target="_blank" 
   rel="noopener noreferrer"
   style="position:absolute; top:22px; left:26px; z-index: 999;">
    <img id="main-logo-button" src="src/Assets/logo.svg" alt="ELTE DOKK logo" />
</a>

@if (GameState.HasActiveSession && GameState.CurrentPlayer is not null)
{
    <div class="stat-bar">
        <PlayerStatsBar Stats="@GameState.CurrentPlayer.Stats" />
    </div>
}

@Body

@code {
    protected override void OnInitialized()
    {
        GameState.Changed += OnGameStateChanged;
    }

    private void OnGameStateChanged() => InvokeAsync(StateHasChanged);

    public void Dispose()
    {
        GameState.Changed -= OnGameStateChanged;
    }
}

